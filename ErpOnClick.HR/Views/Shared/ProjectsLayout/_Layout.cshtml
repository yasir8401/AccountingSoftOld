<!DOCTYPE html>

@{ var isArabic = ErpOnClick.DAL.Utilities.Udf.isArabic(); }


<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>ProjectOnClick</title>

    <link href="~/adminlte/plugins/fontawesome/css/all.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/adminlte/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="~/adminlte/dist/css/custom.css?v=@DateTime.Now.ToString("mm")">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <link href="~/adminlte/plugins/summernote/summernote-bs4.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/adminlte/plugins/datatables/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="~/adminlte/plugins/datatables/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="~/adminlte/plugins/datatables/rowReorder.dataTables.min.css" />
    <link href="~/adminlte/plugins/summernote/summernote.css" rel="stylesheet" />
    <link href="~/adminlte/plugins/chart.js/Chart.min.css" rel="stylesheet" />
    <link href="~/adminlte/plugins/overlayScrollbars/css/OverlayScrollbars.min.css" rel="stylesheet" />

    @if (isArabic)
    {
<link rel="stylesheet" href="~/adminlte/dist/css/rtl.css?v=@DateTime.Now.ToString("mm")">
}

</head>
<body class="sidebar-mini layout-fixed accent-orange ">

    <div class="wrapper">

        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-light navbar-orange ">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                @*<li class="nav-item d-none d-sm-inline-block">
                        <a href="~/home" class="nav-link">Home</a>
                    </li>*@
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="javascript:void(0)" class="nav-link font-weight-bold d-none ">@RenderSection("TabName", false)</a>
                    <a href="javascript:void(0)" class="nav-link text-uppercase text-bold">Projects System</a>

                </li>
               
            </ul>
            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-link right">
                    <partial name="ProjectsLayout/_Culture" />
                </li>
                <!-- Messages Dropdown Menu -->
                <!-- Notifications Dropdown Menu -->
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="far fa-bell"></i>
                        <span class="badge badge-warning navbar-badge pendingApprovalCount">15</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <span class="dropdown-header"><span class="pendingApprovalCount"></span> Notifications</span>
                        <div id="pendingApprovalsTop" style="
    overflow-y: auto;
    max-height: 300px;
    min-height: 0px;
"></div>
                        <div class="dropdown-divider"></div>
                        <a href="~/Approvals/Inbox?status=007001" class="dropdown-item dropdown-footer">See Inbox</a>
                    </div>
                </li>
            </ul>
        </nav>
        <!-- /.navbar -->
        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-orange elevation-4">
            <!-- Brand Logo -->
            <a href="~/home" class="brand-link">
                <img src="~/adminlte/dist/img/Erponclick.png" alt="ErpOnClick" class="brand-image img-circle elevation-3" style="box-shadow: none !important; border: none !important;">
                <span class="brand-text font-weight-light"><b>Projects</b> on click</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user panel (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="~/adminlte/dist/img/avatar04.png" class="img-circle elevation-2" alt="User Image">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">Administrator</a>
                    </div>
                </div>

                <!-- Sidebar Menu -->
                @Html.Partial("ProjectsLayout/_nav")
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">

            <!-- Main content -->
            <div class="content">
                <div class="container-fluid pt-3">
                    @RenderBody()
                    <!-- /.row -->
                </div><!-- /.container-fluid -->
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
            <div class="p-3">
                <h5>Title</h5>
                <p>Sidebar content</p>
            </div>
        </aside>
        <!-- /.control-sidebar -->

    </div>
    <!-- ./wrapper -->
    <!-- REQUIRED SCRIPTS -->
    <!-- jQuery -->
    <script src="~/adminlte/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="~/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="~/adminlte/dist/js/adminlte.min.js"></script>

    <script src="~/adminlte/plugins/fontawesome/js/all.js"></script>

    <!--Plugin for DataTables.net-->
    <script src="~/adminlte/plugins/datatables/jquery.datatables.js"></script>
    <script src="~/adminlte/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/adminlte/plugins/datatables/dataTables.buttons.min.js"></script>
    <script src="~/adminlte/plugins/datatables/buttons.flash.min.js"></script>
    <script src="~/adminlte/plugins/datatables/jszip.min.js"></script>
    <script src="~/adminlte/plugins/datatables/pdfmake.min.js"></script>
    <script src="~/adminlte/plugins/datatables/vfs_fonts.js"></script>
    <script src="~/adminlte/plugins/datatables/buttons.html5.min.js"></script>
    <script src="~/adminlte/plugins/datatables/buttons.print.min.js"></script>
    <script src="~/adminlte/plugins/datatables/dataTables.rowReorder.min.js"></script>

    <!--Sweet Alert 2 plugin-->

    <script src="~/adminlte/plugins/sweetalert/sweetalert2.all.js"></script>
    <script src="~/adminlte/plugins/sweetalert/sweetalert2.js"></script>
    <link rel="stylesheet" href="~/adminlte/plugins/sweetalert/sweetalert2.css" />
    <script src="~/adminlte/plugins/summernote/summernote-bs4.js"></script>
    <script src="~/adminlte/plugins/summernote/summernote.js"></script>

    @*------------------ Date Picker References | Begin ------------------*@
    <link rel="stylesheet" href="~/adminlte/plugins/JqueryDatepicker/css/jquery.calendars.picker.css" />
    <script src="~/adminlte/plugins/JqueryDatepicker/js/jquery.calendars.js"></script>
    <script src="~/adminlte/plugins/JqueryDatepicker/js/jquery.calendars.plus.js"></script>
    <script src="~/adminlte/plugins/JqueryDatepicker/js/jquery.plugin.js"></script>
    <script src="~/adminlte/plugins/JqueryDatepicker/js/jquery.calendars.picker.js"></script>
    <script src="~/adminlte/plugins/JqueryDatepicker/js/jquery.calendars.islamic.js"></script>
    @*@Scripts.Render("~/Scripts/JqueryDatepicker/js/jquery.calendars-ar.js"></script>*@
    @*@Scripts.Render("~/Scripts/JqueryDatepicker/js/jquery.calendars.picker-ar.js"></script>*@

    @*------------------ Select 2 References | Begin ------------------*@
    @*<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>*@

    <script src="~/adminlte/plugins/select2/select2.min.js"></script>
    <link rel="stylesheet" href="~/adminlte/plugins/select2/select2.min.css" />

    <script src="~/adminlte/plugins/maskedinput/jquery.maskedinput.js"></script>

    <script src="~/adminlte/plugins/chart.js/Chart.min.js"></script>

    <!-- overlayScrollbars -->
    <script src="~/adminlte/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>


    @RenderSection("scripts", false);


    <script>
        var _loadingHtml = '<p><i class="fa fa-spin fa-spinner fa-fw"></i> please wait while we process your request</p>';
        $(document).ready(function () {
            initSettings();
            getNotifications();

        });
         function getApplicationName() {
             var applicationName = "@Url.Action("","",new {area = "" })";
                var length = applicationName.length;
                if (applicationName.length != 1) {
                    applicationName = applicationName + "/";
                }
                return applicationName.toString();
    };
        function initSettings() {
            //var userName = localStorage.getItem('FULL_NAME');
            //$('.login-info span  span').text(userName);
            initDatePicker();

            $('.select2').select2();

            $('input[type=file]').bind('change', function () {
                var ext = $(this).val().split('.').pop().toLowerCase();
                if (!(ext == "pdf" || ext == "jpg" || ext == "png")) {
                    document.getElementById(this.id).value = "";
                    showMsg("Invalid File Type !", "You may only upload JPG,PNG and PDF files. Please ensure your file is in one of these formats.", "error");
                    isValidated = false;
                }

                if (this.files[0].size > 2097152) {
                    document.getElementById(this.id).value = "";
                    showMsg("File Too Large !", "File size is too large. The maximum file size is allowed is set to: 200MB", "error");
                    isValidated = false;
                };
            });
        }


        function initDatePicker() {
            //$('.DatePicker').calendarsPicker();
            //$('.DatePicker').attr('readonly', 'readonly');
            $('.DatePicker').css('cursor', 'default');

            $('.DatePicker').calendarsPicker({
                yearRange: 'c-40:c+6',
                dateFormat: 'dd-M-yyyy',
            });
            $('.DatePickerHijri').calendarsPicker($.extend({
                calendar: $.calendars.instance('Islamic', 'ar'),
                yearRange: 'c-40:c+6',
                dateFormat: 'dd-M-yyyy',
            }, $.calendarsPicker.regionalOptions['ar']));


            $('.DatePicker,.DatePickerHijri').attr('autocomplete', 'off');

            $('.DatePicker').on("keypress paste", function (e) {
                e.preventDefault();
            })
        }

        function showMsg(_title, _html, _type) {
            swal({
                title: _title,
                html: _html,
                buttonsStyling: false,
                confirmButtonClass: "btn btn-" + (_type == null ? 'success' : _type) + " btn-fill",
                type: _type,
                timer: 5000
            });
        };


        function confirmDelete(_title, _html) {
            return swal({
                title: _title,
                html: _html,
                type: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Yes, delete it!',
                cancelButtonText: 'No, keep it',
                confirmButtonClass: "btn btn-success btn-fill",
                cancelButtonClass: "btn btn-danger btn-fill",
                buttonsStyling: false
            });
        };

        function confirmAction(_title, _html, _type, _confirmText, _cancelText) {
            return swal({
                title: _title,
                html: _html,
                type: _type,
                showCancelButton: true,
                confirmButtonText: _confirmText,
                cancelButtonText: _cancelText,
                confirmButtonClass: "btn btn-success btn-fill",
                cancelButtonClass: "btn btn-danger btn-fill",
                buttonsStyling: false
            });
        };

        function _initDatatable(objID) {

            // Setup - add a text input to each footer cell
            $(objID + ' tfoot th').each(function () {
                var title = $(this).text();
                $(this).html('<input type="text" class="form-control input-sm" placeholder="Search" />');
            });

            // DataTable
            var table = $(objID).DataTable({
                //"order": [[0, "desc"]],
                dom: 'Bfrtip',
                //"order": [[0, "desc"]],
                "pageLength": 15,
                buttons: [
                    'copy', 'excel'
                ]
            });

            // Apply the search
            table.columns().every(function () {
                var that = this;

                $('input', this.footer()).on('keyup change', function () {
                    if (that.search() !== this.value) {
                        that
                            .search(this.value)
                            .draw();
                    }
                });
            });
        };




        function _initDatatable_Lines(objID) {
            // Setup - add a text input to each footer cell
            $(objID + ' tfoot th').each(function () {
                var title = $(this).text();
                $(this).html('<input type="text" class="form-control input-sm" placeholder="Search ' + title + '" />');
            });

            // DataTable
            var table = $(objID).DataTable({
                dom: 'Bfrtip',
                buttons: [
                    'copy', 'excel'
                ]
            });

            // Apply the search
            table.columns().every(function () {
                var that = this;

                $('input', this.footer()).on('keyup change', function () {
                    if (that.search() !== this.value) {
                        that
                            .search(this.value)
                            .draw();
                    }
                });
            });
        };



        function moveToDiv(divElement) {
            document.getElementById(divElement).scrollIntoView({ block: 'start', behavior: 'smooth' });
        }

        function getNotifications() {
            var applicationName = getApplicationName();
            var sHtml = '';
            $.ajax({
                url: applicationName + 'Home/_notification',
                success: function (response) {
                    $('.pendingApprovalCount').html(response.count);

                    $.each(response.myApprovals, (i, item) => {
                        sHtml += `<div class="dropdown-divider"></div>
                                                                                    <a href="${applicationName}Approvals/Inbox?status=007001" class="dropdown-item ">
<div class="row">
                                                                                         <div class="col-md-10">
<p   data-toggle="tooltip" title="${(item.recordNotes != null ? item.recordNotes : "")} ">
                                        ${(item.recordNotes != null ? item.recordNotes : "")}

</p >
                                            <span class="text-muted text-sm">${new Date(item.createdDate).getDate()}-${new Date(item.createdDate).getMonth()}-${new Date(item.createdDate).getFullYear()}</span>
</div >
                                            <div class="col-md-2"><i class="fas fa-envelope mr-2 float-right"></i></div></div >
                                                                                    </a > `;

                    })
                    $('#pendingApprovalsTop').append(sHtml);

                }
            });


        }
    </script>

</body>
</html>
